<ui:composition template="/WEB-INF/template/layoutPadre.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:o="http://omnifaces.org/ui">


    <ui:define name="titulo">Buses</ui:define>

    <ui:define name="cuerpo">



        <f:metadata>
            <o:viewParam name="ruta" value="#{seleccionarBusBean.ruta}" />
            <f:viewParam name="fechaVenta" value="#{seleccionarBusBean.fechaVenta}">
                <f:convertDateTime pattern="yyyyMMddHHmmss" />
            </f:viewParam>


            <f:event listener="#{seleccionarBusBean.inicializar}"
                     type="preRenderView"/>
        </f:metadata>


        <h1>Buses</h1>



        <h:form id="form">

            <p:growl id="msgs" widgetVar="wmsg" showDetail="true"/>

            <p:messages autoUpdate="true"/>

            <p:toolbar style="margin-top:20px">


                <f:facet name="left">



                        <p:outputLabel value="Fecha Partida:"/>
                        <p:outputLabel value="#{seleccionarBusBean.fechaVenta}">
                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                        </p:outputLabel>

                        <p:outputLabel value="  "/>

                        <p:outputLabel value="Ruta:"/>
                        <p:outputLabel value="#{seleccionarBusBean.ruta.ruta}"/>



                </f:facet>
                <f:facet name="right">
                    <p:commandButton value="Modificar" action="#{seleccionarBusBean.modificarParametros}" update="@form"/>
                </f:facet>
            </p:toolbar>

            <h:panelGroup id="myPanel" rendered="#{seleccionarBusBean.mostrarParametros}">



                    <p:outputLabel for="fechaPartida" value="Fecha Partida:"/>
                    <p:calendar id="fechaPartida" value="#{seleccionarBusBean.nuevaFechaVenta}" showOn="button"
                                update=":form" >


                        <p:ajax event="dateSelect" listener="#{seleccionarBusBean.onFechaSeleccionada}"
                                update="msgs,ruta, :form"/>
                    </p:calendar>

                    <p:outputLabel value="  "/>

                    <p:outputLabel for="ruta" value="Ruta:"/>
                    <p:inputText id="ruta" value="#{seleccionarBusBean.ruta.ruta}" size="30" readonly="true"/>
                    <p:commandButton value="Ruta" icon="ui-icon-extlink"
                                     actionListener="#{seleccionarBusBean.seleccionarRuta}">
                        <p:ajax event="dialogReturn" listener="#{seleccionarBusBean.onRutaSeleccionada}"
                                update="msgs,ruta, :form"/>

                    </p:commandButton>


            </h:panelGroup>


            <p:dataTable id="programacionesTable"
                         value="#{seleccionarBusBean.programaciones}" var="programacion"
                         style="margin-top:20px"
                         emptyMessage="No se encontraron programaciones para esta fecha de Venta" rows="20"
                         paginator="true" paginatorAlwaysVisible="false"
                         paginatorPosition="bottom">

                <p:column headerText="Id" style="text-align:center;width:100px">
                    <h:outputLabel value="#{programacion.ideProgramacion}" />
                </p:column>

                <p:column headerText="Fecha Programacion" >
                    <h:outputLabel value="#{programacion.fechaProgramacion}" />
                </p:column>

                <p:column headerText="Bus" style="text-align:center;width:150px">
                    <h:outputLabel value="#{programacion.bus.descripcionBus}" />
                </p:column>

                <p:column headerText="Hora Salida" >
                    <h:outputLabel value="#{programacion.horaSalida}" />
                </p:column>


                <p:column headerText="Hora Llegada" >
                    <h:outputLabel value="#{programacion.horaLlegada}" />
                </p:column>

                <p:column headerText="Estado" >
                    <h:outputLabel value="#{programacion.tipoProgramacion}" />
                </p:column>

                <p:column style="text-align:center;width:100px">
                    <p:button  value="Asientos" outcome="/ventas/seleccionarAsientos">

                        <f:param name="programacion" value="#{programacion.ideProgramacion}" />
                    </p:button>

                </p:column>

            </p:dataTable>

            <p:confirmDialog global="true">
                <p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check"/>
                <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close"/>
            </p:confirmDialog>





        </h:form>

    </ui:define>




</ui:composition>


